# WEB靶场搭建教程（PHPstudy+SQLllib+DVWA+upload-labs）

url：https://www.freebuf.com/articles/web/270837.html



# WEB靶场搭建教程

## 0x00 简介

渗透测试靶场基于“未知功焉知防”的理念，通过模拟真实的漏洞环境不断地训练和提高使用者的渗透测试技巧和能力，本次为大家带来几款热门的WEB靶场。

## 0x01 PHPstudy

作为一名积极进取的渗透从业者，电脑上肯定不止一个靶场，这时候想让它们乖乖的正常运行彼此不受干扰就不可避免的会进行WEB配置，这时候相信大家看见Apache、Tomcat、Nginx的配置文件就头大，毕竟我们现阶段的学习重心是渗透技巧；所以这里推荐大家一款PHP建站神器—phpstudty

废话不多说，给出如下地址

```
下载地址：https://www.xp.cn/download.html

安装教程：https://www.xp.cn/wenda/389.html

搭建站点：https://www.xp.cn/wenda/394.html
```

提示：安装完成后需要手工修改数据库root账号密码

![1619179944_6082b9a873da8b2096cfd.png!small?1619179944932](images/1619179944_6082b9a873da8b2096cfd.png!small)



此外，phpstudy默认的数据库管理工具phpmyadmin作者个人不怎么使用，推荐大家使用navcat进行连接

最后，推荐使用WAMP组合(后续都以WAMP为基础)



![1619179957_6082b9b5246ea45a5e718.png!small?1619179957715](images/1619179957_6082b9b5246ea45a5e718.png!small)

## 0x02 搭建SQLi-labs靶场

```
项目地址：https://github.com/Audi-1/sqli-labs/

下载链接：https://codeload.github.com/Audi-1/sqli-labs/zip/refs/heads/master
```

1 下载项目并解压到磁盘上

![1619179969_6082b9c160d3dea368875.png!small?1619179969908](images/1619179969_6082b9c160d3dea368875.png!small)

2 使用phpstudy创建站点

![1619179976_6082b9c814b8a47c544fe.png!small?1619179976561](images/1619179976_6082b9c814b8a47c544fe.png!small)

注意：

1. 域名随意设置，但是必填且唯一(即便不用)
2. 如果不想通过域名访问就要保证端口号唯一
3. 如果想通过域名访问就要勾选同步hosts(杀软可能会告警，无视即可)
4. php版本建议使用5.4

3 修改sql-connections目录下的db-creds.inc

![1619179998_6082b9de4b14a1f43ca7f.png!small?1619179998816](images/1619179998_6082b9de4b14a1f43ca7f.png!small)

![1619180006_6082b9e6a04917fe81c9e.png!small?1619180007265](images/1619180006_6082b9e6a04917fe81c9e.png!small)

4 打开浏览器访问域名，点击Setup/Reset Database初始化数据库

![1619180013_6082b9ed78446d707019b.png!small](images/1619180013_6082b9ed78446d707019b.png!small)



此时数据库已初始化成功，如果看到一堆Error就要检查账号密码是否正确以及数据库服务是否开启

5 测试

回到主页点击Less-1

![1619308418_6084af82bd2704a889c8c.png!small?1619308419700](images/1619308418_6084af82bd2704a889c8c.png!small)

![1619308424_6084af8872bc7f92992b6.png!small](images/1619308424_6084af8872bc7f92992b6.png!small)作者提示我们他希望输入一个数字ID作为参数，那就来一个GET参数试试

![1619308548_6084b0049db748ab53e23.png!small?1619308549579](images/1619308548_6084b0049db748ab53e23.png!small)

靶场运行正常！

## 0x03 搭建DVWA靶场

**有了上面的基础，接下来的步骤直接加速**

```
项目地址：https://codeload.github.com/digininja/DVWA/zip/master
```

1 下载并解压

![1619308464_6084afb01dae1907e29fc.png!small?1619308465040](images/1619308464_6084afb01dae1907e29fc.png!small)

2 进入config目录，复制其中文件并去掉dist后缀

![1619308577_6084b021b00838cef17fc.png!small?1619308578630](images/1619308577_6084b021b00838cef17fc.png!small)

3 打开config.inc.php

![1619308590_6084b02e518b7904cce40.png!small?1619308591212](images/1619308590_6084b02e518b7904cce40.png!small)

由于部分小伙伴对于数据库并不熟悉，所以推荐大家使用root账号

![1619308595_6084b0334e5186aab84d0.png!small?1619308596274](images/1619308595_6084b0334e5186aab84d0.png!small)

4 使用phpstudy创建站点

![1619308604_6084b03cd3ee21f48d036.png!small?1619308605852](images/1619308604_6084b03cd3ee21f48d036.png!small)

5 访问域名

![1619308610_6084b042a5c52e35d84e6.png!small?1619308611616](images/1619308610_6084b042a5c52e35d84e6.png!small)

dvwa的检测程序提示我们部分功能未开启

6 开启URL包含功能

打开PHP配置文件php.ini(注意要打开与站点配置相同版本的)

![1619308641_6084b061e82263aafba6d.png!small?1619308643619](images/1619308641_6084b061e82263aafba6d.png!small)

搜索allow_url_include，可见此时是关闭的

![1619308654_6084b06ea120cc9f81df7.png!small?1619308655525](images/1619308654_6084b06ea120cc9f81df7.png!small)

将Off修改为On

![1619308661_6084b0757d759d4d64a48.png!small?1619308662476](images/1619308661_6084b0757d759d4d64a48.png!small)

7 回到首页重启WEB服务器

![1619308673_6084b081ad192290cec49.png!small?1619308674610](images/1619308673_6084b081ad192290cec49.png!small)

8 回到浏览器刷新页面

![1619308680_6084b0884399bbe982024.png!small?1619308681213](images/1619308680_6084b0884399bbe982024.png!small)

可见环境检测通过

9 点击Create/Reset Database初始化数据库

![1619308686_6084b08edd71123f3c5bf.png!small?1619308687833](images/1619308686_6084b08edd71123f3c5bf.png!small)

10 点击login

![1619308701_6084b09d33341856f4d20.png!small?1619308702063](images/1619308701_6084b09d33341856f4d20.png!small)

dvwa默认账号密码为：admin password

11 成功登录至DVWA靶场

![1619308704_6084b0a0eccd2c6dbc172.png!small?1619308705893](images/1619308704_6084b0a0eccd2c6dbc172.png!small)

## 0x04 搭建upload-labs靶场

```
项目官网：https://github.com/c0ny1/upload-labs

项目源码：https://codeload.github.com/c0ny1/upload-labs/zip/refs/tags/0.1
```

**说明：该靶场需要修改部分配置，可能会与其他靶场产生冲突，如果不想被莫名其妙的问题在折磨，可以使用作者安装好的环境(使用单独一套WEB配置)，但是需要额外注意端口冲突等问题**

**如果不想自己动手直接快进到本节第六部分**



上面两个都是使用不同域名相同端口区分站点，接下来使用不同端口区分站点

1 下载并解压文件

![1619308729_6084b0b9d8efd33b8f97b.png!small?1619308730759](images/1619308729_6084b0b9d8efd33b8f97b.png!small)

在根目录下创建upload目录

![1619308734_6084b0bed46bba9f0a675.png!small?1619308735782](images/1619308734_6084b0bed46bba9f0a675.png!small)

2 重点看下官网的介绍

![1619308739_6084b0c339844faaf7af1.png!small?1619308740088](images/1619308739_6084b0c339844faaf7af1.png!small)

PHP版本推荐5.2.17，开启gd2和exif拓展同时设置Apache以moudel方式连接

3 使用phpstudy创建站点

![1619308743_6084b0c7050d5e6fcedba.png!small?1619308743950](images/1619308743_6084b0c7050d5e6fcedba.png!small)

**注意：本次端口号使用23333**

4 开启PHP拓展

检查gd2拓展和exif拓展(点击对应的拓展名即可开启/关闭)

![1619308749_6084b0cd56c3eaae0b91e.png!small?1619308750287](images/1619308749_6084b0cd56c3eaae0b91e.png!small)

5 设置Apache以moudel方式连接

**注意：当系统存在多个站点时(特别是PHP版本不同)不能设置此选项，该步骤仅作为演示教学**

定位php5apache2_2.dll

![1619308756_6084b0d4edb1cac68edd0.png!small?1619308757934](images/1619308756_6084b0d4edb1cac68edd0.png!small)

打开Apache配置文件httpd.ini

![1619308762_6084b0da9ab56d3833305.png!small?1619308763554](images/1619308762_6084b0da9ab56d3833305.png!small)

增加配置

![1619308771_6084b0e3ebcd37cae87f4.png!small?1619308772977](images/1619308771_6084b0e3ebcd37cae87f4.png!small)

![1619308777_6084b0e91bd0ffc3847b3.png!small?1619308778054](images/1619308777_6084b0e91bd0ffc3847b3.png!small)

重启WEB服务器

6 打开站点测试

![1619308784_6084b0f00de9f2158529e.png!small?1619308785011](images/1619308784_6084b0f00de9f2158529e.png!small)

OK，可以收工了

## 0x05 END

靶场搭建完毕后就要不断地练习练习再练习

希望各位早日成为红队大佬