# 渗透神器：burpsuit教程之intruder模块

url：https://www.freebuf.com/articles/web/270618.html



## 0x00 前言

上文介绍了BP的Repeater模块，该模块可以实现对数据包进行修改和重新发送，进而对目标系统进行微调测试。本节将以此为基础为大家演示intruder模块。

## 0x01 Intruder简介

Intruder是可定制的、高度可配的工具，常用于对web应用程序进行自动化攻击，基本流程为设置代理并开启拦截请求，将拦截到的数据包发送到Intruder模块，添加需要攻击的参数，设置参数字典，开始攻击。

就这么直接扔简介怕是一头雾水，接下来通过一个小案例为大家演示它的用法和一些使用技巧

## 0x02 环境搭建

现如今绝大多数系统都要先登录后使用，本次搭建了一个简历的登录页面和验证逻辑，任务是通过BP弄出正确的账号，由于源码较少直接贴图

注意：为了模拟真实环境，源码中的账号和密码已经打了厚码，可以随意填写一组(千万注意要用单引号包围起来)![1619167280_60828830282c6264a1e78.png!small?1619167280541](images/1619167280_60828830282c6264a1e78.png!small)

![1619167290_6082883a9a74e8d448ce3.png!small?1619167291152](images/1619167290_6082883a9a74e8d448ce3.png!small)![1619167296_60828840dd8c124d1cc71.png!small?1619167297379](images/1619167296_60828840dd8c124d1cc71.png!small)使用phpstudy创建站点

![1619167322_6082885ad5cebc2b8c219.png!small?1619167323451](images/1619167322_6082885ad5cebc2b8c219.png!small)

```
访问http://localhost/login.html
```

查看效果![1619167361_608288817b0325716e06e.png!small?1619167361867](images/1619167361_608288817b0325716e06e.png!small)

输入连续10年霸榜的账号：admin 123456![1619167367_60828887d7f197f61fd09.png!small?1619167368247](images/1619167367_60828887d7f197f61fd09.png!small)

OK，一切运行正常。接下来开始进入主题

## 0x03 为什么需要Intruder

这个问题可以从接下来的内容获取答案

首先打开BP设置代理(用BP自带的浏览器可以忽略此步骤)

访问

```
http://localhost/login.html
```

![1619167382_6082889685f8ea2902c2c.png!small?1619167382915](images/1619167382_6082889685f8ea2902c2c.png!small)开启截断，随意输入一组账号密码点击登录![1619167388_6082889cdecaf4abb7149.png!small?1619167389228](images/1619167388_6082889cdecaf4abb7149.png!small)

成功拦截到登录请求包，光速发送到Repeater![1619167398_608288a685f6e217d3f05.png!small?1619167399015](images/1619167398_608288a685f6e217d3f05.png!small)

现在有两种方式爆破账号密码：

1、在浏览器中尝试

2、在BP中修改参数值

无论哪种方式都需要手工进行修改并发送，费时费力，这时候要是有一款能够自动化测试的工具就香了，Intruder也由此而生

## 0x04 Intruder介绍

将登录的请求包发送至Intruder![1619167406_608288aeea346e1b4c39c.png!small?1619167407372](images/1619167406_608288aeea346e1b4c39c.png!small)

Intruder下有四个部分，接下来逐个介绍

### 4.1 Target

该部分设置攻击目标，包含目标主机(域名或IP)、目标端口以及是否使用HTTPS协议发送数据包

### 4.2 Positions

该部分主要设置攻击模式以及指明“恶意数据”的位置，每一处恶意代码都用一对$包围，在本例中需要爆破用户名和密码

![1619167414_608288b64f669905e0eca.png!small?1619167414777](images/1619167414_608288b64f669905e0eca.png!small)

PS：添加攻击位置仅需鼠标选中数据片段点击右侧添加即可

**![1619167419_608288bbc762e9f25f15f.png!small?1619167420207](images/1619167419_608288bbc762e9f25f15f.png!small)**

**攻击类型介绍![1619167428_608288c489807d17ab494.png!small?1619167428948](images/1619167428_608288c489807d17ab494.png!small)**

狙击手：使用同一组数据对每一个位置都测试一遍，不同位置相互独立

![1619167436_608288ccc996111b95bf7.png!small?1619167437217](images/1619167436_608288ccc996111b95bf7.png!small)

![1619167441_608288d1cef104187e038.png!small?1619167442310](images/1619167441_608288d1cef104187e038.png!small)

![1619167455_608288dfeddc1a4183849.png!small?1619167456266](images/1619167455_608288dfeddc1a4183849.png!small)![1619167476_608288f4b17ea1e160b0a.png!small?1619167477233](images/1619167476_608288f4b17ea1e160b0a.png!small)![1619167483_608288fb778a8ed08cbcc.png!small?1619167483833](images/1619167483_608288fb778a8ed08cbcc.png!small)破城槌：在所有的位置同步使用同一组测试数据

![1619167489_60828901b623415ce87d0.png!small?1619167490176](images/1619167489_60828901b623415ce87d0.png!small)

![1619167501_6082890d2ec0179aa59d2.png!small?1619167501588](images/1619167501_6082890d2ec0179aa59d2.png!small)![1619167506_608289127682c946ac268.png!small?1619167506862](images/1619167506_608289127682c946ac268.png!small)音叉：允许为每个位置单独设置一组数据

![1619167512_60828918b3ea4c4e94401.png!small?1619167513118](images/1619167512_60828918b3ea4c4e94401.png!small)

![1619167524_608289247dd8fc155176f.png!small?1619167524900](images/1619167524_608289247dd8fc155176f.png!small)![1619167532_6082892c1cae8da0eb585.png!small?1619167532463](images/1619167532_6082892c1cae8da0eb585.png!small)集束弹：允许为每个位置设置一组数据，不同于音叉，BP会自动对数据进行组合，组合方式类似于笛卡尔积![1619167538_60828932353db8c568cdf.png!small?1619167538933](images/1619167538_60828932353db8c568cdf.png!small)

### ![1619167547_6082893b6e2dfaeb056aa.png!small?1619167547934](images/1619167547_6082893b6e2dfaeb056aa.png!small)![1619167552_608289407e02809bac68d.png!small?1619167552902](images/1619167552_608289407e02809bac68d.png!small)![1619167559_60828947a37d14961c9fa.png!small?1619167560064](images/1619167559_60828947a37d14961c9fa.png!small)4.3 Payloads

在刚才添加测试数据时已经介绍一半了，不过刚才使用的是直接添加，当数据量较大时这个方法肯定不太行，BP为我们提供了从文件中读取数据的功能![1619167566_6082894ee675a03758160.png!small?1619167567338](images/1619167566_6082894ee675a03758160.png!small)

注意文件内容的换行符尽量使用系统标准换行符

有些时候发送的数据要经过一些编码或者其他处理，这时候负载处理器提供规则设定功能，比如将所有的数据包都进行SHA1运算

![1619167574_60828956d83aea6dd3618.png!small?1619167575295](images/1619167574_60828956d83aea6dd3618.png!small)

![1619167582_6082895e91385a747eaf5.png!small?1619167582952](images/1619167582_6082895e91385a747eaf5.png!small)此外，BP还支持自定义自动编码的字符![1619167589_60828965b57879e5f700e.png!small?1619167590168](images/1619167589_60828965b57879e5f700e.png!small)

### 4.4 Options

该部分为Intruder的设置

请求引擎处，线程数可以根据目标系统的负载能力和实际情况灵活设定

![1619167601_608289716dc28c6a17ec7.png!small?1619167602040](images/1619167601_608289716dc28c6a17ec7.png!small)

正则匹配支持在响应包中检索内容并标识，正则提取支持从响应包中检索并提取![1619167609_60828979b16c85e7e3df8.png!small?1619167610329](images/1619167609_60828979b16c85e7e3df8.png!small)

其余选项可以根据实际情况选择![1619167620_60828984b0db62feca82f.png!small](images/1619167620_60828984b0db62feca82f.png!small)

## 0x05 实战

说了这么多，回到本次的演示环节中，通过Intruder爆破出预设的用户名和密码吧。

准备两份字典分别存储可能的用户名和密码，推荐将正确的账号密码混入其中![1619167635_60828993d3fb24beebf87.png!small?1619167636333](images/1619167635_60828993d3fb24beebf87.png!small)

通过上面的介绍，爆破密码最好使用集束弹模式![1619167650_608289a253205f697ba51.png!small?1619167650727](images/1619167650_608289a253205f697ba51.png!small)

设置测试数据![1619167654_608289a6c0b78bc2210d0.png!small?1619167655229](images/1619167654_608289a6c0b78bc2210d0.png!small)

![1619167681_608289c134be6edf33996.png!small?1619167681911](images/1619167681_608289c134be6edf33996.png!small)设置保持默认即可，开始攻击![1619167669_608289b504c1114cc4ea0.png!small?1619167669429](images/1619167669_608289b504c1114cc4ea0.png!small)

结果很快就完成了，但是面对繁杂的条目如何挑选想要的结果呢，这里推荐大家一个基础方法就是看数据包状态和长度，由于本次环境响应码都是200，所以重点关注响应数据的长度，点击长度可以对结果进行排序

![1619167699_608289d3048e738af9bdd.png!small?1619167699388](images/1619167699_608289d3048e738af9bdd.png!small)![1619167714_608289e20dfb7325a21b0.png!small?1619167714474](images/1619167714_608289e20dfb7325a21b0.png!small)发现有一项与其他格格不入，点击查看详细数据

![1619167721_608289e98e2c587f2b9b2.png!small?1619167721999](images/1619167721_608289e98e2c587f2b9b2.png!small)嘿嘿，渗透有时候就是这么容易~~~

## 0x06 END

随着攻防对抗不断升级，爆破难度逐渐提高，以后各位还会通过BP拓展插件、浏览器自动化测试、脚本测试等多种途径得到通行证。